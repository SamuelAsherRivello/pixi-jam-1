(()=>{"use strict";var e,i,t={2617:(e,i,t)=>{var s=t(3174),n=t(6571),a=t.n(n),r=t(7871),o=t(4493),l=t(7007);class c{get isInitialized(){return this._isInitialized}_app;_isInitialized=!1;constructor(e){this._app=e}async initializeAsync(){}requireIsInitialized(){if(!this.isInitialized)throw new Error("Systems are not initialized.")}}class h{static textureIsNullOrEmpty(e){return null===e||e===s.gPd.EMPTY}static stringIsNullOrEmpty(e){return null===e||""===e}static hasInterface(e,i){return Object.keys(i).every((i=>i in e))}}const p={canCollisionBeChecked:!0};class u extends c{get stageContainers(){return this._stageContainers}stageContainersRefresh(){this._stageContainers=this.stageContainersRefreshRecursive(this._app.app.stage)}_stageContainers;constructor(e){super(e)}async initializeAsync(){this.isInitialized||(this._isInitialized=!0)}stageContainersCollidingWith(e){return this.stageContainersRefresh(),this.getCollisionsInternal(e,this._stageContainers)}stageContainersRefreshRecursive(e){const i=[];return e.children.forEach((e=>{i.push(e),e instanceof s.mcf&&e.children.length>0&&i.push(...this.stageContainersRefreshRecursive(e))})),i}getCollisionsInternal(e,i){return i.filter((i=>{const t=h.hasInterface(i,p);return i!==e&&t&&i.canCollisionBeChecked&&this.isCollidingWith(e,i)}))}isCollidingWith(e,i){const t=e.getBounds(),s=i.getBounds();return t.x<s.x+s.width&&t.x+t.width>s.x&&t.y<s.y+s.height&&t.y+s.height>s.y}}const d={canCollisionCheck:!0,isTickable:!0,isResizable:!0};class m extends s.mcf{get isInitialized(){return this._isInitialized}get configuration(){return this._configuration}get canCollisionCheck(){return this._canCollisionCheck}isChild(){return null!==this.parent}_isDestroyed=!1;_configuration;_isInitialized=!1;_canCollisionCheck=!0;_app;constructor(e,i){super(),this._configuration={...d,...i},this._app=e,this.configuration.isTickable&&this._app.app.ticker.add(this.onTickInternal.bind(this)),this.configuration.isResizable&&this._app.addListener(v.EVENT_RESIZE,this.onResizeInternal.bind(this))}requireIsInitialized(){if(!this.isInitialized)throw new Error("requireIsInitialized.")}async initializeAsync(){this._isInitialized||(this._isInitialized=!0)}destroy(e){this.requireIsInitialized(),this._isDestroyed||(this.configuration.isTickable&&this._app.app.ticker.remove(this.onTickInternal.bind(this)),this.configuration.isResizable&&this._app.removeListener(v.EVENT_RESIZE,this.onResizeInternal.bind(this)),this._isDestroyed=!0,super.destroy(e))}onAdded(){}onRemoved(){}onResize(e){}onTick(e){if(!this.canCollisionCheck)return;const i=this._app.systems.collisionSystem.stageContainersCollidingWith(this);i.length&&this.onCollision(i)}onCollision(e){}onTickInternal(e){this._isDestroyed||this.onTick(e)}onResizeInternal(e){this._isDestroyed||this.onResize(e)}}class y extends c{_keyStateDictionary;constructor(e){super(e),this._keyStateDictionary=new Map,window.addEventListener("keydown",this.onKeyDown.bind(this)),window.addEventListener("keyup",this.onKeyUp.bind(this))}async initializeAsync(){this.isInitialized||(this._isInitialized=!0)}isKeyDown(e){return this.getKeyStateByKey(e).isDown}isKeyDownThisFrame(e){let i=this.getKeyStateByKey(e),t=i.isDownThisFrame;return i.isDownThisFrame=!1,t}onKeyDown(e){let i=this.getKeyStateByKey(e.key);i.isDown?i.isDownThisFrame=!1:(i.isDown=!0,i.isDownThisFrame=!0)}onKeyUp(e){let i=this.getKeyStateByKey(e.key);i.isDown=!1,i.isDownThisFrame=!1}getKeyStateByKey(e){let i=this._keyStateDictionary.get(e);if(null==i){let i=new g;return this._keyStateDictionary.set(e,i),i}return i}update(){this._keyStateDictionary.forEach((e=>{e.isDownThisFrame=!1}))}}class g{constructor(){this.isDown=!1,this.isDownThisFrame=!1}isDown;isDownThisFrame}var w=t(2287);class f extends c{_audioContextResumed=!1;constructor(e){super(e)}async initializeAsync(){this.isInitialized||(this._isInitialized=!0,this.setupAudioContextResume())}setupAudioContextResume(){const e=()=>{if(!this._audioContextResumed){const e=w.s3.context.audioContext;"suspended"===e.state?e.resume().then((()=>{this._audioContextResumed=!0,console.log("Audio context resumed")})).catch((e=>{console.error("Failed to resume audio context:",e)})):this._audioContextResumed=!0}};window.addEventListener("click",e,{once:!0}),window.addEventListener("touchstart",e,{once:!0}),window.addEventListener("keydown",e,{once:!0})}async play(e){this.playAsync(e)}async playAsync(e){if(!this._audioContextResumed)return void console.warn("Audio context not resumed yet. Cannot play sound.");let i=w.AB.from({url:e,preload:!0,autoPlay:!1});for(;!i.isLoaded;)await new Promise((e=>setTimeout(e,100)));i.speed=1,i.volume=1,i.play()}}var _=t(7115);class T extends c{isDebug=!1;constructor(e){super(e)}async initializeAsync(){if(this.isInitialized)return;this.consoleLog("initializeAsync()"),this._isInitialized=!0;const e=(0,_.io)("http://localhost:3001");e.on("connect",(()=>{this.consoleLog("Connected to server"),e.emit("message","Hello from client!")})),e.on("message",(e=>{this.consoleLog("Message from server: "+e)})),e.on("disconnect",(()=>{this.consoleLog("Disconnected from server")})),e.on("connection",(e=>{this.consoleLog("connection to socket: "+e.id)})),e.io.on("error",(e=>{this.consoleLog("error from socket: "+e)})),e.io.on("ping",(()=>{this.consoleLog("ping from socket ")})),e.on("customEvent",((e,i)=>{this.consoleLog(e)}))}consoleLog(e){this.isDebug&&console.log(`[${T.name}] ${e}`)}}class x extends c{_tilemap;constructor(e){super(e)}async initializeAsync(){this.isInitialized||(this._isInitialized=!0)}setTilemap(e){this._tilemap=e}isCollision(e,i,t,s){if(!this._tilemap)throw new Error("TilemapCollisionSystem: Tilemap must be set first");return this._tilemap.isCollision(e,i,t,s)}}const C={widthInitial:1920,heightInitial:1080,minFPS:1,maxFPS:240,backgroundColor:1087931,data:{}};class I{get isInitialized(){return this._isInitialized}tilemapCollisionSystem;collisionSystem;inputSystem;audioSystem;multiplayerSystem;_isInitialized=!1;constructor(e){this.collisionSystem=new u(e),this.tilemapCollisionSystem=new x(e),this.inputSystem=new y(e),this.audioSystem=new f(e),this.multiplayerSystem=new T(e)}async initializeAsync(){return await Promise.all([this.collisionSystem.initializeAsync(),this.inputSystem.initializeAsync(),this.audioSystem.initializeAsync(),this.multiplayerSystem.initializeAsync()])}requireIsInitialized(){if(!this.isInitialized)throw new Error("Systems are not initialized.")}}class v extends l.EventEmitter{static EVENT_INITIALIZE_COMPLETE="initializeComplete";static EVENT_INITIALIZE_ERROR="initializeError";static EVENT_RESIZE="resize";get isInitialized(){return this._isInitialized}get isFullscreen(){return this._isFullscreen}set isFullscreen(e){this._isFullscreen=e;var i=document.getElementById(this.app.canvas.id);this._isFullscreen?i?.requestFullscreen&&i?.requestFullscreen():document.fullscreenEnabled&&document.exitFullscreen()}reload(){document.location.reload()}get systems(){return this._systems}get configuration(){return this._configuration}app;viewport;_configuration;_canvasId;_isInitialized=!1;_systems;_isFullscreen=!1;constructor(e="pixi-application-canvas",i){super(),this._canvasId=e,this.app=new s.lgM,this._configuration={...C,...i},this._systems=new I(this),this.setMaxListeners(100)}async initializeAsync(){if(!this._isInitialized){this._isInitialized=!0,await this._systems.initializeAsync();try{await this.app.init({canvas:document.getElementById(this._canvasId),backgroundColor:this.configuration.backgroundColor,width:this.configuration.widthInitial,height:this.configuration.heightInitial,resizeTo:window,antialias:!0,backgroundAlpha:1,powerPreference:"high-performance",eventMode:"passive",eventFeatures:{move:!0,globalMove:!0,click:!0,wheel:!1}}),this.app.ticker.minFPS=this.configuration.minFPS,this.app.ticker.maxFPS=this.configuration.maxFPS;let e="WebGL";navigator.gpu&&(e="(WebGL, WebGPU)"),console.log(`PIXI.Application.init() success! PixiJS v${s.xvI} ...\nRendering Supported : ${e}. Rendering Active : ${this.GetRendererTypeAsString(this.app.renderer.type)}.`),this.viewport=new o.LM({screenWidth:this.app.screen.width,screenHeight:this.app.screen.height,worldWidth:3e3,worldHeight:3e3,events:this.app.renderer.events}),this.viewport.center=this.getScreenCenterpoint(),this.app.ticker.add((e=>{this.viewport.update(e.deltaMS)})),this.emit(v.EVENT_INITIALIZE_COMPLETE,this),this.setupResizeHandling(),this.addToStage(this.viewport),this.viewport.label="Viewport"}catch(e){console.log(`PIXI.Application.init() failed! PixiJS v${s.xvI} with ${this.GetRendererTypeAsString(this.app.renderer.type)} `),this.emit(v.EVENT_INITIALIZE_ERROR,e)}}}requireIsInitialized(){if(!this.isInitialized)throw new Error("requireIsInitialized.")}GetRendererTypeAsString(e){let i="Unknown";switch(e){case s.W3c.WEBGL:i="WebGL";break;case s.W3c.WEBGPU:i="WebGPU";break;case s.W3c.BOTH:i="BOTH";break;default:i="Unknown"}return i}addToViewport(e){this.requireIsInitialized(),this.viewport.addChild(e),e instanceof m&&e.onAdded(),this.resize()}removeFromViewport(e){this.requireIsInitialized(),this.viewport.removeChild(e),e instanceof m&&e.onRemoved(),this.resize()}addToStage(e,i){this.requireIsInitialized(),null==i?this.app.stage.addChild(e):i.addChild(e),e instanceof m&&e.onAdded(),this.resize()}removeFromStage(e,i){this.requireIsInitialized(),null==i?this.app.stage.removeChild(e):i.removeChild(e),e instanceof m&&e.onRemoved(),this.resize()}resize=()=>{this.emit(v.EVENT_RESIZE,this)};setupResizeHandling(){const e=()=>{setTimeout(this.resize,100)};window.addEventListener("resize",this.resize),window.addEventListener("resize",e),window.addEventListener("orientationchange",this.resize),window.addEventListener("orientationchange",e),this.resize()}getScreenScaleCurrent(){return new s.bRX(this.app.screen.width/this.configuration.widthInitial,this.app.screen.height/this.configuration.heightInitial)}getScreenCenterpoint(){return new s.bRX(this.app.screen.width/2,this.app.screen.height/2)}}class z{collisionMap;_app;_Tilemap;constructor(e,i){this._app=e,this._Tilemap=i}async initializeAsync(){this.collisionMap=this.createCollisionMap(this._Tilemap.tilemapData)}createCollisionMap(e){if(!e.layers||!e.tilesets)throw new Error("Invalid tilemapData: layers or tilesets are missing");const i=e.layers,t=e.tilesets,s=Array.from({length:e.height},(()=>Array(e.width).fill(!1))),n={};return t.forEach((e=>{e.tiles&&e.tiles.forEach((i=>{i.properties&&i.properties.forEach((t=>{"IsCollision"===t.name&&(n[e.firstgid+i.id]=t.value)}))}))})),i.forEach((e=>{if("tilelayer"===e.type&&e.data)for(let i=0;i<e.height;i++)for(let t=0;t<e.width;t++){const a=e.data[i*e.width+t];n[a]&&(s[i][t]=!0)}})),s}isCollision(e,i,t,n){const a=new s.bRX(e,i),r=new s.bRX;this._app.app.stage.toGlobal(a,r);const o=this._Tilemap.tilemapData.tilewidth,l=this._Tilemap.tilemapData.tileheight,c=Math.floor((r.x-this._Tilemap.x)/o),h=Math.ceil((r.x-this._Tilemap.x+t)/o),p=Math.floor((r.y-this._Tilemap.y)/l),u=Math.ceil((r.y-this._Tilemap.y+n)/l),d=(Math.floor(a.x/o),Math.floor(a.y/l),Math.floor((r.x-this._Tilemap.x)/o),Math.floor((r.y-this._Tilemap.y)/l),new s.bRX);this._Tilemap.toGlobal(new s.bRX(0,0),d);for(let e=p;e<u;e++)for(let i=c;i<h;i++)if(e>=0&&e<this.collisionMap.length&&i>=0&&i<this.collisionMap[0].length&&this.collisionMap[e][i])return!0;return!1}}var S;!function(e){e.TileLayer="tilelayer",e.ObjectGroup="objectgroup"}(S||(S={}));class b extends m{get tilemapData(){return this._tilemapData}_tilemapDataUrl;_TilemapItemFactory;_TilemapCollisionSystem;_tilemapData;constructor(e,i,t){super(e,{canCollisionCheck:!1,isTickable:!1,isResizable:!1}),this._tilemapDataUrl=i,this._TilemapItemFactory=t,this._TilemapCollisionSystem=new z(this._app,this),this.isRenderGroup=!0,this.interactive=!1,this.interactiveChildren=!1,this.label=b.name,this.position.set(0,0),this.scale.set(1),this.isRenderGroup=!0}get isInitialized(){return this._isInitialized}async initializeAsync(){if(this.isInitialized)return;if(await super.initializeAsync(),this._isInitialized=!0,h.stringIsNullOrEmpty(this._tilemapDataUrl))throw new Error(`Tilemap.initializeAsync() file missing error. tilemapDataUrl = "${this._tilemapDataUrl}"`);if(!this._tilemapDataUrl.endsWith(".tmj"))throw new Error(`Tilemap.initializeAsync() file extension error. tilemapDataUrl = "${this._tilemapDataUrl}"`);let e;try{e=await fetch(this._tilemapDataUrl)}catch(e){throw new Error(`Tilemap.initializeAsync() fetch error. tilemapDataUrl = "${this._tilemapDataUrl}"`)}try{this._tilemapData=await e.json()}catch(e){throw new Error(`Tilemap.initializeAsync() json error. tilemapDataUrl = "${this._tilemapDataUrl}"`)}const i=this._tilemapData.tilesets.map((e=>{const i=e.image.replace("../","assets/");return s.sP.load(i).then((()=>({...e,texture:s.gPd.from(i)})))})),t=await Promise.all(i);for(const e of this._tilemapData.layers)e.type===S.TileLayer?await this.processTileLayer(e,t):e.type===S.ObjectGroup&&e.objects&&await this.processObjectLayer(e,t);this._TilemapCollisionSystem.initializeAsync()}requireIsInitialized(){throw new Error("Method not implemented.")}async processTileLayer(e,i){for(let t=0;t<e.height;t++)for(let n=0;n<e.width;n++){const a=e.data?e.data[t*e.width+n]:0;if(a>0){const e=this.getTilesetForTile(a,i);if(e){const i=a-e.firstgid,r=i%e.columns*e.tilewidth,o=Math.floor(i/e.columns)*e.tileheight,l=new s.M_G(r,o,e.tilewidth,e.tileheight),c=new s.gPd({source:e.texture.source,frame:l}),h={x:n*e.tilewidth,y:t*e.tileheight,row:t,column:n,texture:c,layerType:S.TileLayer,type:this.getTileType(e,i)||""},p=await this._TilemapItemFactory.createTilemapItem(this,h);p.label=`Tile (${t.toString().padStart(2,"0")},${n.toString().padStart(2,"0")})`,p.x=h.x,p.y=h.y,this.addChild(p)}}}}async processObjectLayer(e,i){for(const t of e.objects){const e=this.getTilesetForTile(t.gid,i);if(e){const i=t.gid-e.firstgid,n=i%e.columns*e.tilewidth,a=Math.floor(i/e.columns)*e.tileheight,r=new s.M_G(n,a,e.tilewidth,e.tileheight),o=new s.gPd({source:e.texture.source,frame:r});let l="",c=t.type,p=this.getTileType(e,i)?.toString();h.stringIsNullOrEmpty(c)?null==p||h.stringIsNullOrEmpty(p)||(l=p):l=c;const u=-1,d={x:t.x,y:t.y-e.tileheight,row:u,column:u,texture:o,layerType:S.ObjectGroup,type:l},m=await this._TilemapItemFactory.createTilemapItem(this,d);m.label=`Object (${t.id})`,m.x=d.x,m.y=d.y,this.addChild(m)}}}isCollision(e,i,t,s){return this._TilemapCollisionSystem.isCollision(e,i,t,s)}async onAdded(){await this.initializeAsync()}getTilesetForTile(e,i){for(let t=i.length-1;t>=0;t--)if(e>=i[t].firstgid)return i[t];return null}onRemoved(){for(;this.children.length>0;){const e=this.removeChildAt(0);e instanceof s.kxk&&e.destroy({children:!0,texture:!0})}}onResize(e){}onTick(e){}getTileType(e,i){if(!e.tiles)return;const t=e.tiles.find((e=>e.id===i));return t?.type}}const E={textStyle:new s.xJt,canCollisionCheck:!1,isTickable:!0,isResizable:!0};class A extends m{get configuration(){return this._configuration}get textString(){return this._text.text}set textString(e){this._text.text=e,this.onResize(this._app)}_text;constructor(e,i,t){super(e,{...E,...t});const n={style:this.configuration.textStyle,resolution:2};this._text=new s.EYj(n),this.addChild(this._text),this.initializeAsync(),this.label=A.name,this._text.text=i}async initializeAsync(){await super.initializeAsync()}onTick(e){super.onTick(e)}}class k extends A{onResize(e){this.x=e.configuration.data.screenUIMarginX,this.y=e.configuration.data.screenUIMarginY,this._text.style.fontSize=15+7/e.app.renderer.resolution}}class R extends A{onResize(e){this.x=e.app.screen.width-this.width-e.configuration.data.screenUIMarginX,this.y=e.configuration.data.screenUIMarginY,this._text.style.fontSize=15+7/e.app.renderer.resolution}}var D=t(1559);class F{_animationNameToAnimatedSprite;_textureImageURL;_spriteSheetURL;constructor(e,i){this._textureImageURL=e,this._spriteSheetURL=i,this._animationNameToAnimatedSprite=new Map}async initializeAndReparent(e,i){const t=await fetch(this._spriteSheetURL),n=await t.json();await s.sP.load(this._textureImageURL);const a=s.gPd.from(this._textureImageURL),r=new s.zo6(a,n);await r.parse();const o=new s.bRX(n.meta.size.w,n.meta.size.h);for(const[e,i]of Object.entries(r.animations))this._animationNameToAnimatedSprite.set(e,new s.Dl5(i));this._animationNameToAnimatedSprite.forEach(((e,t)=>{e.setSize(o.x,o.y),e.label=F.name,e.anchor.set(.5,.5),i.addChild(e)}))}play(e,i){const t=this._animationNameToAnimatedSprite.get(e);if(null==t)throw new Error("Trying to play unknown animation with animationName="+e);t.animationSpeed=i,t.play()}}const M={canCollisionCheck:!0,isTickable:!0,isResizable:!0};class L extends m{_multiAnimatedSprite;constructor(e,i){super(e,{...M,...i}),this.label=L.name,this.initializeAsync()}async initializeAsync(){await super.initializeAsync(),this._multiAnimatedSprite=new F("assets/images/AnimatedCoin/animated_coin.png","assets/images/AnimatedCoin/animated_coin.json"),await this._multiAnimatedSprite.initializeAndReparent(this._app,this),this._multiAnimatedSprite.play("Gold",.2)}onTick(e){super.onTick(e)}}class P{spinAndShrink(e,i,t,s,n){return r.En.sequence(r.En.delay(i),r.En.runFunc((()=>{s()})),r.En.parallel(r.En.rotateTo(e,1,t,r.Uq.smooth2),r.En.scaleTo(e,0,0,t,r.Uq.smooth2)),r.En.runFunc((()=>{n()})))}riseAndGrow(e,i,t,s,n){return r.En.sequence(r.En.delay(i),r.En.runFunc((()=>{s()})),r.En.parallel(r.En.moveTo(e,e.x,e.y-e.height,t,r.Uq.smooth2),r.En.scaleTo(e,2,2,t,r.Uq.smooth2)),r.En.runFunc((()=>{n()})))}}class U{static Animations=new P}class O extends L{get canCollisionBeChecked(){return!0}constructor(e){super(e,{canCollisionCheck:!1,isTickable:!1,isResizable:!1}),this.label=O.name}whatever(){this.isCollected=!0,this.destroyAfterAnimation()}async initializeAsync(){await super.initializeAsync(),this.filters=[new D.GD({blur:1,alpha:.5,quality:3,resolution:2})]}destroyAfterAnimation(){U.Animations.riseAndGrow(this,0,20,(()=>{this._app.systems.audioSystem.play("./assets/audio/Chime01.mp3")}),(()=>{this.destroy()})).play()}isCollected=!1;collect(){this.isCollected||(this.isCollected=!0,this.destroyAfterAnimation())}}const V={textureUrl:"",texture:s.gPd.EMPTY,canCollisionCheck:!0,isTickable:!0,isResizable:!0};class N extends m{get configuration(){return this._configuration}_sprite;constructor(e,i){if(super(e,{...V,...i}),!h.textureIsNullOrEmpty(this.configuration?.texture)&&!h.stringIsNullOrEmpty(this.configuration?.textureUrl))throw new Error("You cannot set both texture and textureUrl in the configuration");this.initializeAsync(),this.label=N.name}async initializeAsync(){if(await super.initializeAsync(),h.textureIsNullOrEmpty(this.configuration?.texture)){if(!h.stringIsNullOrEmpty(this.configuration?.textureUrl)){await s.sP.load([this.configuration.textureUrl]);const e=s.gPd.from(this.configuration.textureUrl);this._sprite=new s.kxk(e)}}else this._sprite=new s.kxk(this.configuration?.texture);this._sprite&&(this._sprite.label=this.label,this.addChild(this._sprite),this._sprite.anchor.set(.5,.5))}onTick(e){super.onTick(e)}}class j extends N{get canCollisionBeChecked(){return!0}constructor(e,i){i&&(i.canCollisionCheck=!1),super(e,i),this.label=j.name}async initializeAsync(){await super.initializeAsync(),this.filters=[new D.GD({blur:1,alpha:.5,quality:3,resolution:2})]}onTick(e){super.onTick(e),this.rotation+=.01*e.deltaTime}destroyAfterAnimation(){U.Animations.spinAndShrink(this,0,20,(()=>{this._app.systems.audioSystem.play("./assets/audio/Chime02.mp3")}),(()=>{this.destroy()})).play()}isCollected=!1;collect(){this.isCollected||(this.isCollected=!0,this.destroyAfterAnimation())}}const G={textureUrl:"",texture:s.gPd.EMPTY,canCollisionCheck:!0,isTickable:!0,isResizable:!0};class q extends N{get canCollisionBeChecked(){return!0}constructor(e,i){super(e,{...G,...i}),this.label=q.name,this.on("pointerdown",(e=>{this.position.x+=10})),this.eventMode="static"}async initializeAsync(){await super.initializeAsync(),this._sprite.filters=[new D.GD({blur:1,alpha:.5,quality:3,resolution:2})],this._sprite.anchor.set(0,0)}isCollisionWithTilemap(e,i){return this._app.systems.tilemapCollisionSystem.isCollision(e,i,32,32)}onTick(e){super.onTick(e);let i=new s.bRX(0,0);const t=this._app.systems.inputSystem.isKeyDown("m");this._app.systems.inputSystem.isKeyDown("a")&&(i.x+=-1),this._app.systems.inputSystem.isKeyDown("d")&&(i.x+=1),this._app.systems.inputSystem.isKeyDown("w")&&(i.y+=-1),this._app.systems.inputSystem.isKeyDown("s")&&(i.y+=1),(this._app.systems.inputSystem.isKeyDownThisFrame("Enter")||this._app.systems.inputSystem.isKeyDownThisFrame("Spacebar"))&&this._app.systems.audioSystem.play("./assets/audio/Click01.wav"),this._app.systems.inputSystem.isKeyDownThisFrame("f")&&(this._app.isFullscreen=!this._app.isFullscreen,this._app.systems.audioSystem.play("./assets/audio/Click01.wav")),this._app.systems.inputSystem.isKeyDownThisFrame("r")&&(this._app.systems.audioSystem.play("./assets/audio/Click01.wav"),this._app.reload());const n=t?10:3,a=this.position.x+i.x*e.deltaTime*n,r=this.position.y+i.y*e.deltaTime*n;0===i.x||this.isCollisionWithTilemap(a,this.position.y)||(this.position.x=a),0===i.y||this.isCollisionWithTilemap(this.position.x,r)||(this.position.y=r)}onCollision(e){e.forEach((e=>{const i=this._app.configuration.data;if(e instanceof O&&!e.isCollected)return e.collect(),void i.coinsCollected.Value++;e instanceof j&&!e.isCollected&&e.collect()}))}}class K extends N{constructor(e,i){super(e,i),this.label=K.name}async initializeAsync(){await super.initializeAsync()}}class B extends K{constructor(e,i){super(e,i),this.label=B.name}async initializeAsync(){await super.initializeAsync()}}class W extends K{constructor(e,i){super(e,i),this.label=W.name}async initializeAsync(){await super.initializeAsync()}}class X{_app;constructor(e){this._app=e}async createTilemapItem(e,i){const t=this._app.configuration.data;switch(i.layerType){case S.TileLayer:return new s.kxk(i.texture);case S.ObjectGroup:switch(i.type){case j.name:const n={textureUrl:"",texture:i.texture,canCollisionCheck:!1,isTickable:!0,isResizable:!1};return new j(this._app,n);case O.name:return t.coinsMax.Value++,new O(this._app);case B.name:let a=new B(this._app,{texture:i.texture});a.alpha=.1,console.log("#hack Tilemap positions player poorly.");let r=new s.bRX(i.x/2-116,i.y/2+8);return this._app.configuration.data.playerSpawnpoint=e.toGlobal(r),a;case W.name:let o=new W(this._app,{texture:i.texture});return o.alpha=.1,console.log("#hack Tilemap positions enemy poorly."),this._app.configuration.data.enemySpawnpoint=new s.bRX(400,400),o;default:return new s.kxk(i.texture)}}}}class ${eventEmitter=new l.EventEmitter;eventName="valueChanged";on(e){this.eventEmitter.on(this.eventName,e)}off(e){this.eventEmitter.off(this.eventName,e)}invoke(e,i){this.eventEmitter.emit(this.eventName,e,i)}refresh(e,i){this.invoke(e,i)}}class Y{OnValueChanged;_currentValue;_previousValue;constructor(e){if(this.OnValueChanged=new $,void 0===e)throw new Error("Initial value must be provided");this._currentValue=e,this._previousValue=e}get Value(){return this._currentValue}set Value(e){this._currentValue=this.OnValueChanging(this._currentValue,e),this.OnValueChanged.invoke(this._previousValue,this._currentValue),this._previousValue=this._currentValue}OnValueChanging(e,i){return i}refreshValueChanged(){this.OnValueChanged.refresh(this._previousValue,this._currentValue)}}class Z extends N{displayMessage;constructor(e,i){super(e),this.displayMessage=i,this.label=Z.name}async initializeAsync(){await super.initializeAsync();const e=(new s.A1g).rect(0,0,32,32).fill({color:16777215,alpha:.5});e.x=-e.width/2,e.y=-e.height/2,this.addChild(e);const i=new s.EYj(this.displayMessage,{align:"center",fontSize:12,fill:16777215});i.x=-i.width/2,i.y=-i.height/2,this.addChild(i)}}const H={moveSpeed:.25,textureUrl:"",texture:s.gPd.EMPTY,canCollisionCheck:!0,isTickable:!0,isResizable:!0};class J extends N{get canCollisionBeChecked(){return!0}get configuration(){return this._configuration}target;constructor(e,i){super(e,{...H,...i}),this.label=J.name}async initializeAsync(){await super.initializeAsync(),this._sprite.filters=[new D.GD({blur:1,alpha:.5,quality:3,resolution:2})],this._sprite.anchor.set(0,0)}getStageContainersOfTypePlayer(){return this._app.systems.collisionSystem.stageContainers.filter((e=>e instanceof q))}moveTowardsTarget(){const e=this.target.x,i=this.target.y,t=e-this.x,s=i-this.y,n=Math.sqrt(t*t+s*s);if(n>this.configuration.moveSpeed){const e=t/n,i=s/n;this.x+=e*this.configuration.moveSpeed,this.y+=i*this.configuration.moveSpeed}else this.x=e,this.y=i}onTick(e){super.onTick(e),this.target||(this.target=this.getStageContainersOfTypePlayer()[0],console.log("Found : "+this.target)),this.target&&this.moveTowardsTarget()}}s.kpn.defaultOptions.roundPixels=!0,s.kpn.defaultOptions.resolution=window.devicePixelRatio||2;const Q={logoImageUrl:"assets/images/pixijs-logo-32x32.png",tilemapDataUrl:"assets/tilemaps/TreasureHunter2D.tmj",playerTextureUrl:"assets/images/player-default-sprite.png",enemyTextureUrl:"assets/images/enemy-default-sprite.png",coinsCollected:new Y(0),coinsMax:new Y(0),screenUIMarginX:10,screenUIMarginY:10,playerSpawnpoint:new s.bRX(0,0),enemySpawnpoint:new s.bRX(0,0)};let ee,ie,te,se,ne,ae;const re=new v("pixi-application-canvas",{widthInitial:1920,heightInitial:1080,minFPS:1,maxFPS:240,backgroundColor:8881786,data:Q}),oe=new(a());oe.showPanel(0),oe.dom.className="stats-panel",document.body.appendChild(oe.dom),globalThis.__PIXI_APP__=re.app,re.addListener(v.EVENT_INITIALIZE_COMPLETE,(async function(e){const i=new b(e,Q.tilemapDataUrl,new X(e));await i.initializeAsync(),e.addToViewport(i),i.x=e.getScreenCenterpoint().x-i.width/2,i.y=e.getScreenCenterpoint().y-i.height/2,e.systems.tilemapCollisionSystem.setTilemap(i),ne=new Z(e,"World(0,0)"),e.addToViewport(ne),ne.position=new s.bRX,se=new Z(e,"Screen(C,C)"),e.addToViewport(se),se.position=e.getScreenCenterpoint(),ae=new Z(e,"Tilemap(0,0)"),e.addToViewport(ae),ae.position=i.position;const t=new J(e,{textureUrl:Q.enemyTextureUrl});e.addToViewport(t),t.position=e.configuration.data.enemySpawnpoint,te=new q(e,{textureUrl:Q.playerTextureUrl}),e.addToViewport(te),te.position=e.configuration.data.playerSpawnpoint,e.viewport.follow(te,{speed:1,acceleration:1,radius:20});const n=new s.xJt;function a(){ee.textString=`Coins ${Q.coinsCollected.Value}/${Q.coinsMax.Value}`;const i=e.configuration.data;i.coinsCollected.Value>=i.coinsMax.Value&&e.reload()}n.fontFamily="Arial",n.fontSize=40,n.fill="#ffffff",ie=new k(e,"Arrows / WASD To Move\nEnter / Spacebar For Attack\nF For Fullscreen\nR For Restart\nM For Move Fast",{textStyle:n}),e.addToStage(ie),ee=new R(e,"Replace Later",{textStyle:n}),e.addToStage(ee),e.app.ticker.add((e=>{oe.begin(),r.En.tick(e.deltaTime),oe.end()})),a(),Q.coinsCollected.OnValueChanged.on(a),Q.coinsMax.OnValueChanged.on(a)})),re.addListener(v.EVENT_INITIALIZE_ERROR,(function(e){console.error(`PIXI.Application.init() failed. error = ${e}`)})),(async()=>{await re.initializeAsync()})()}},s={};function n(e){var i=s[e];if(void 0!==i)return i.exports;var a=s[e]={exports:{}};return t[e].call(a.exports,a,a.exports,n),a.exports}n.m=t,e=[],n.O=(i,t,s,a)=>{if(!t){var r=1/0;for(h=0;h<e.length;h++){for(var[t,s,a]=e[h],o=!0,l=0;l<t.length;l++)(!1&a||r>=a)&&Object.keys(n.O).every((e=>n.O[e](t[l])))?t.splice(l--,1):(o=!1,a<r&&(r=a));if(o){e.splice(h--,1);var c=s();void 0!==c&&(i=c)}}return i}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[t,s,a]},n.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return n.d(i,{a:i}),i},n.d=(e,i)=>{for(var t in i)n.o(i,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:i[t]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((i,t)=>(n.f[t](e,i),i)),[])),n.u=e=>e+"."+{142:"6f46ecf1ff524851e045",151:"061e9e13269897ecbd38",162:"1046d09f72d0e3563e18",421:"796907ff150e4ce2813a",440:"d6ee605c48ad4a368abe",751:"1c7e18eea6655a094d79",852:"15740e5671b245293199"}[e]+".bundle.js",n.miniCssF=e=>{},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),i={},n.l=(e,t,s,a)=>{if(i[e])i[e].push(t);else{var r,o;if(void 0!==s)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var h=l[c];if(h.getAttribute("src")==e){r=h;break}}r||(o=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.src=e),i[e]=[t];var p=(t,s)=>{r.onerror=r.onload=null,clearTimeout(u);var n=i[e];if(delete i[e],r.parentNode&&r.parentNode.removeChild(r),n&&n.forEach((e=>e(s))),t)return t(s)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),o&&document.head.appendChild(r)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var i=n.g.document;if(!e&&i&&(i.currentScript&&(e=i.currentScript.src),!e)){var t=i.getElementsByTagName("script");if(t.length)for(var s=t.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=t[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),(()=>{var e={792:0};n.f.j=(i,t)=>{var s=n.o(e,i)?e[i]:void 0;if(0!==s)if(s)t.push(s[2]);else{var a=new Promise(((t,n)=>s=e[i]=[t,n]));t.push(s[2]=a);var r=n.p+n.u(i),o=new Error;n.l(r,(t=>{if(n.o(e,i)&&(0!==(s=e[i])&&(e[i]=void 0),s)){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;o.message="Loading chunk "+i+" failed.\n("+a+": "+r+")",o.name="ChunkLoadError",o.type=a,o.request=r,s[1](o)}}),"chunk-"+i,i)}},n.O.j=i=>0===e[i];var i=(i,t)=>{var s,a,[r,o,l]=t,c=0;if(r.some((i=>0!==e[i]))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(l)var h=l(n)}for(i&&i(t);c<r.length;c++)a=r[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(h)},t=self.webpackChunk=self.webpackChunk||[];t.forEach(i.bind(null,0)),t.push=i.bind(null,t.push.bind(t))})();var a=n.O(void 0,[433],(()=>n(2617)));a=n.O(a)})();
//# sourceMappingURL=main.347bf2e59f8d7de9331c.bundle.js.map